# ‚úÖ Paso 14: Configurar CI/CD con GitHub Actions + GitLab CI/CD + Jenkins

Ahora implementaremos pipelines de CI/CD para pruebas automatizadas y despliegues usando:
‚úÖ GitHub Actions ‚Üí Para repositorios en GitHub, con workflows automatizados.
‚úÖ GitLab CI/CD ‚Üí Para proyectos alojados en GitLab.
‚úÖ Jenkins ‚Üí Para entornos personalizados o servidores propios.
üìå Commit 14.1: Configurar GitHub Actions para Pruebas y Linting
üîπ Mensaje de commit:
ci(github-actions): agrega workflow para pruebas y linting en GitHub Actions
üîπ Contenido del commit:
# Crear la estructura para GitHub Actions
mkdir -p .github/workflows
touch .github/workflows/ci.yml
# Definir workflow de CI en GitHub Actions
echo "
name: CI
on:
push:
branches: - main
pull_request:
branches: - main
jobs:
test:
runs-on: ubuntu-latest
services:
postgres:
image: postgres
env:
POSTGRES_USER: postgres
POSTGRES_PASSWORD: password
POSTGRES_DB: test_db
ports: - 5432:5432
    steps:
      - name: Checkout c√≥digo
        uses: actions/checkout@v3
      - name: Configurar Ruby
        uses: ruby/setup-ruby@v1
        with:
          ruby-version: 3.2
          bundler-cache: true
      - name: Instalar dependencias
        run: bundle install
      - name: Configurar Base de Datos
        run: |
          bin/rails db:create db:migrate RAILS_ENV=test
      - name: Ejecutar pruebas
        run: bin/rails test
      - name: Ejecutar RuboCop
        run: bundle exec rubocop
" > .github/workflows/ci.yml
# A√±adir archivos al commit
git add .
git commit -m "ci(github-actions): agrega workflow para pruebas y linting en GitHub Actions"
üìå Commit 14.2: Configurar GitLab CI/CD para Pruebas y Despliegues
üîπ Mensaje de commit:
ci(gitlab-ci): agrega configuraci√≥n de GitLab CI/CD para pruebas y despliegue autom√°tico
üîπ Contenido del commit:
# Crear archivo de configuraci√≥n para GitLab CI/CD
touch .gitlab-ci.yml
# Definir pipeline en GitLab CI/CD
echo "
stages:
- test
- deploy
test:
image: ruby:3.2
services: - postgres
before_script: - apt-get update -qq && apt-get install -y nodejs postgresql-client - bundle install - bin/rails db:create db:migrate RAILS_ENV=test
script: - bin/rails test - bundle exec rubocop
deploy:
stage: deploy
only: - main
script: - echo 'Desplegando aplicaci√≥n...' - ./scripts/deploy.sh
" > .gitlab-ci.yml
# A√±adir archivos al commit
git add .
git commit -m "ci(gitlab-ci): agrega configuraci√≥n de GitLab CI/CD para pruebas y despliegue autom√°tico"
üìå Commit 14.3: Configurar Jenkins Pipeline para Servidores Propios
üîπ Mensaje de commit:
ci(jenkins): agrega configuraci√≥n de Jenkinsfile para pruebas y despliegue en servidores propios
üîπ Contenido del commit:
# Crear archivo de configuraci√≥n para Jenkins
touch Jenkinsfile
# Definir pipeline en Jenkins
echo "
pipeline {
agent any
    stages {
        stage('Checkout') {
            steps {
                git 'https://github.com/user/company_app.git'
            }
        }
        stage('Test') {
            steps {
                sh 'bundle install'
                sh 'bin/rails db:create db:migrate RAILS_ENV=test'
                sh 'bin/rails test'
            }
        }
        stage('Deploy') {
            when {
                branch 'main'
            }
            steps {
                sh './scripts/deploy.sh'
            }
        }
    }
}
" > Jenkinsfile
# A√±adir archivos al commit
git add .
git commit -m "ci(jenkins): agrega configuraci√≥n de Jenkinsfile para pruebas y despliegue en servidores propios"
üìù Explicaci√≥n y C√≥digo Generado
GitHub Actions (.github/workflows/ci.yml)
    Ejecuta pruebas y RuboCop en cada push o PR.
    Usa PostgreSQL como base de datos en el entorno de prueba.
GitLab CI/CD (.gitlab-ci.yml)
    Ejecuta pruebas y RuboCop en cada commit.
    Despliega autom√°ticamente en el servidor cuando se mergea en main.
Jenkins (Jenkinsfile)
    Clona el repositorio.
    Ejecuta pruebas y RuboCop.
    Despliega en servidores propios si el commit es en main.
