# ‚úÖ Paso 10: Configurar Logs y Monitoreo con Lograge + DataDog

Ahora mejoraremos la observabilidad del sistema mediante Lograge para estructurar los logs y DataDog para monitoreo avanzado.
‚úÖ Lograge ‚Üí Formatea los logs de Rails en JSON para mejorar su lectura y an√°lisis.
‚úÖ DataDog APM ‚Üí Captura m√©tricas de rendimiento y errores en tiempo real.
‚úÖ Integraci√≥n con DataDog Logs ‚Üí Para centralizar logs de la aplicaci√≥n en la plataforma de DataDog.
üìå Commit 10.1: Instalar Lograge y Configurar Logs en JSON
üîπ Mensaje de commit:
feat(logging): instala Lograge y configura logs en formato JSON
üîπ Contenido del commit:
# A√±adir Lograge al Gemfile
echo "gem 'lograge', '~> 0.12.0'" >> Gemfile
# Instalar la gema
bundle install
# Configurar Lograge en Rails
echo "
Rails.application.configure do
config.lograge.enabled = true
config.lograge.formatter = Lograge::Formatters::Json.new
end
" >> config/environments/production.rb
# A√±adir archivos al commit
git add .
git commit -m "feat(logging): instala Lograge y configura logs en formato JSON"
üìå Commit 10.2: Configurar Integraci√≥n con DataDog APM
üîπ Mensaje de commit:
feat(monitoring): agrega integraci√≥n con DataDog APM para m√©tricas de rendimiento
üîπ Contenido del commit:
# A√±adir la gema DataDog APM
echo "gem 'ddtrace', '~> 1.8'" >> Gemfile
# Instalar la gema
bundle install
# Configurar DataDog en Rails
echo "
Datadog.configure do |c|
c.use :rails
c.use :active_record
c.use :redis
end
" >> config/initializers/datadog.rb
# A√±adir archivos al commit
git add .
git commit -m "feat(monitoring): agrega integraci√≥n con DataDog APM para m√©tricas de rendimiento"
üìå Commit 10.3: Enviar Logs de Rails a DataDog
üîπ Mensaje de commit:
feat(logging): configura env√≠o de logs de Rails a DataDog
üîπ Contenido del commit:
# Configurar DataDog Logger
echo "
Rails.application.configure do
config.logger = Datadog::Logger.new('rails.log')
end
" >> config/environments/production.rb
# A√±adir archivos al commit
git add .
git commit -m "feat(logging): configura env√≠o de logs de Rails a DataDog"
üìù Explicaci√≥n y C√≥digo Generado
Ejemplo de Logs en JSON con Lograge
{
"method": "GET",
"path": "/users",
"status": 200,
"duration": 35.4,
"time": "2024-03-12T12:34:56Z",
"params": { "query": "admin" }
}
Ejemplo de Env√≠o de Logs a DataDog
Rails.logger.info("Este es un log de prueba enviado a DataDog")
Ejemplo de M√©tricas en DataDog APM
# Verificar que DataDog APM est√° capturando datos
datadog-agent status
