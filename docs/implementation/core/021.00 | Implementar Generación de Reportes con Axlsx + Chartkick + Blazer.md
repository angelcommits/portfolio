# ✅ Paso 21: Implementar Generación de Reportes con Axlsx + Chartkick + Blazer

Ahora configuraremos Axlsx, Chartkick y Blazer para generación y visualización de reportes.
✅ Axlsx → Exportación de reportes a Excel (.xlsx).
✅ Chartkick → Visualización de gráficos interactivos en la UI.
✅ Blazer → Creación de reportes dinámicos basados en consultas SQL dentro de Rails.
📌 Commit 21.1: Instalar Axlsx para Exportación de Reportes en Excel
🔹 Mensaje de commit:
feat(reports): instala Axlsx y agrega exportación de reportes en Excel
🔹 Contenido del commit:
# Añadir la gema Axlsx al Gemfile
echo "gem 'axlsx_rails', '~> 0.6.0'" >> Gemfile
# Instalar la gema
bundle install
# Crear servicio para generación de reportes
mkdir -p app/services
touch app/services/excel_report_generator.rb
Definir el Servicio ExcelReportGenerator
require "axlsx"
class ExcelReportGenerator
def self.generate_user_report(users)
package = Axlsx::Package.new
workbook = package.workbook
    workbook.add_worksheet(name: "Usuarios") do |sheet|
      sheet.add_row ["ID", "Nombre", "Email"]
      users.each { |user| sheet.add_row [user.id, user.name, user.email] }
    end
    package.to_stream.read
end
end
🔹 Añadir archivos al commit:
git add .
git commit -m "feat(reports): instala Axlsx y agrega exportación de reportes en Excel"
📌 Commit 21.2: Integrar Reportes en Excel en la API
🔹 Mensaje de commit:
feat(reports): expone endpoint para exportar reportes de usuarios en Excel
🔹 Contenido del commit:
Modificar UsersController para exportar Excel
class UsersController < ApplicationController
def index
@users = Company::Business::User.all
    respond_to do |format|
      format.html
      format.json { render json: @users }
      format.xlsx do
        send_data ExcelReportGenerator.generate_user_report(@users),
                  filename: "usuarios.xlsx",
                  type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
      end
    end
end
end
🔹 Añadir archivos al commit:
git add .
git commit -m "feat(reports): expone endpoint para exportar reportes de usuarios en Excel"
📌 Commit 21.3: Instalar Chartkick y Agregar Gráficos en la UI
🔹 Mensaje de commit:
feat(reports): instala Chartkick y agrega visualización de reportes en la UI
🔹 Contenido del commit:
# Añadir Chartkick y Chart.js al Gemfile
echo "gem 'chartkick', '~> 4.1'" >> Gemfile
echo "gem 'groupdate', '~> 5.3'" >> Gemfile
# Instalar las gemas
bundle install
Agregar un Gráfico en la Vista users/index.html.erb
<%= line_chart Company::Business::User.group_by_day(:created_at).count %>
🔹 Añadir archivos al commit:
git add .
git commit -m "feat(reports): instala Chartkick y agrega visualización de reportes en la UI"
📌 Commit 21.4: Instalar Blazer para Reportes Dinámicos con SQL
🔹 Mensaje de commit:
feat(reports): instala Blazer para creación de reportes SQL en Rails
🔹 Contenido del commit:
# Añadir Blazer al Gemfile
echo "gem 'blazer', '~> 2.6'" >> Gemfile
# Instalar la gema
bundle install
# Generar la configuración de Blazer
rails g blazer:install
# Ejecutar migraciones
rails db:migrate
# Agregar Blazer a las rutas
echo "mount Blazer::Engine, at: 'blazer'" >> config/routes.rb
🔹 Añadir archivos al commit:
git add .
git commit -m "feat(reports): instala Blazer para creación de reportes SQL en Rails"
📝 Explicación y Código Generado
Ejemplo de Exportación de Excel en API
curl -X GET "http://localhost:3000/users.xlsx" -o usuarios.xlsx
Ejemplo de Visualización de Gráficos en Rails
<%= bar_chart Company::Business::User.group_by_month(:created_at).count %>
Acceder a la Interfaz de Blazer
    URL: http://localhost:3000/blazer
    Permite ejecutar consultas SQL personalizadas y visualizar datos de forma interactiva.
