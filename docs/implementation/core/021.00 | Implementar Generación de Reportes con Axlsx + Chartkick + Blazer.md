# âœ… Paso 21: Implementar GeneraciÃ³n de Reportes con Axlsx + Chartkick + Blazer

Ahora configuraremos Axlsx, Chartkick y Blazer para generaciÃ³n y visualizaciÃ³n de reportes.
âœ… Axlsx â†’ ExportaciÃ³n de reportes a Excel (.xlsx).
âœ… Chartkick â†’ VisualizaciÃ³n de grÃ¡ficos interactivos en la UI.
âœ… Blazer â†’ CreaciÃ³n de reportes dinÃ¡micos basados en consultas SQL dentro de Rails.
ğŸ“Œ Commit 21.1: Instalar Axlsx para ExportaciÃ³n de Reportes en Excel
ğŸ”¹ Mensaje de commit:
feat(reports): instala Axlsx y agrega exportaciÃ³n de reportes en Excel
ğŸ”¹ Contenido del commit:
# AÃ±adir la gema Axlsx al Gemfile
echo "gem 'axlsx_rails', '~> 0.6.0'" >> Gemfile
# Instalar la gema
bundle install
# Crear servicio para generaciÃ³n de reportes
mkdir -p app/services
touch app/services/excel_report_generator.rb
Definir el Servicio ExcelReportGenerator
require "axlsx"
class ExcelReportGenerator
def self.generate_user_report(users)
package = Axlsx::Package.new
workbook = package.workbook
    workbook.add_worksheet(name: "Usuarios") do |sheet|
      sheet.add_row ["ID", "Nombre", "Email"]
      users.each { |user| sheet.add_row [user.id, user.name, user.email] }
    end
    package.to_stream.read
end
end
ğŸ”¹ AÃ±adir archivos al commit:
git add .
git commit -m "feat(reports): instala Axlsx y agrega exportaciÃ³n de reportes en Excel"
ğŸ“Œ Commit 21.2: Integrar Reportes en Excel en la API
ğŸ”¹ Mensaje de commit:
feat(reports): expone endpoint para exportar reportes de usuarios en Excel
ğŸ”¹ Contenido del commit:
Modificar UsersController para exportar Excel
class UsersController < ApplicationController
def index
@users = Company::Business::User.all
    respond_to do |format|
      format.html
      format.json { render json: @users }
      format.xlsx do
        send_data ExcelReportGenerator.generate_user_report(@users),
                  filename: "usuarios.xlsx",
                  type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
      end
    end
end
end
ğŸ”¹ AÃ±adir archivos al commit:
git add .
git commit -m "feat(reports): expone endpoint para exportar reportes de usuarios en Excel"
ğŸ“Œ Commit 21.3: Instalar Chartkick y Agregar GrÃ¡ficos en la UI
ğŸ”¹ Mensaje de commit:
feat(reports): instala Chartkick y agrega visualizaciÃ³n de reportes en la UI
ğŸ”¹ Contenido del commit:
# AÃ±adir Chartkick y Chart.js al Gemfile
echo "gem 'chartkick', '~> 4.1'" >> Gemfile
echo "gem 'groupdate', '~> 5.3'" >> Gemfile
# Instalar las gemas
bundle install
Agregar un GrÃ¡fico en la Vista users/index.html.erb
<%= line_chart Company::Business::User.group_by_day(:created_at).count %>
ğŸ”¹ AÃ±adir archivos al commit:
git add .
git commit -m "feat(reports): instala Chartkick y agrega visualizaciÃ³n de reportes en la UI"
ğŸ“Œ Commit 21.4: Instalar Blazer para Reportes DinÃ¡micos con SQL
ğŸ”¹ Mensaje de commit:
feat(reports): instala Blazer para creaciÃ³n de reportes SQL en Rails
ğŸ”¹ Contenido del commit:
# AÃ±adir Blazer al Gemfile
echo "gem 'blazer', '~> 2.6'" >> Gemfile
# Instalar la gema
bundle install
# Generar la configuraciÃ³n de Blazer
rails g blazer:install
# Ejecutar migraciones
rails db:migrate
# Agregar Blazer a las rutas
echo "mount Blazer::Engine, at: 'blazer'" >> config/routes.rb
ğŸ”¹ AÃ±adir archivos al commit:
git add .
git commit -m "feat(reports): instala Blazer para creaciÃ³n de reportes SQL en Rails"
ğŸ“ ExplicaciÃ³n y CÃ³digo Generado
Ejemplo de ExportaciÃ³n de Excel en API
curl -X GET "http://localhost:3000/users.xlsx" -o usuarios.xlsx
Ejemplo de VisualizaciÃ³n de GrÃ¡ficos en Rails
<%= bar_chart Company::Business::User.group_by_month(:created_at).count %>
Acceder a la Interfaz de Blazer
    URL: http://localhost:3000/blazer
    Permite ejecutar consultas SQL personalizadas y visualizar datos de forma interactiva.
