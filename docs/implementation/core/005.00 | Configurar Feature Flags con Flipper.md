# ✅ Paso 5: Configurar Feature Flags con Flipper

Ahora agregaremos Flipper para manejar Feature Flags, lo que nos permitirá habilitar o deshabilitar funcionalidades en tiempo de ejecución sin necesidad de cambiar el código.
✅ Flipper → Permite activar o desactivar características por usuario, grupo, porcentaje, etc.
✅ Integración con PostgreSQL → Para persistencia de los Feature Flags.
✅ Interfaz administrativa → Para gestionar los Feature Flags desde la aplicación.
📌 Commit 5.1: Instalar Flipper y configurar almacenamiento en PostgreSQL
🔹 Mensaje de commit:
feat(feature-flags): instala Flipper y configura PostgreSQL como backend
🔹 Contenido del commit:
# Añadir Flipper al Gemfile
echo "gem 'flipper', '~> 1.0'" >> Gemfile
echo "gem 'flipper-active_record', '~> 1.0'" >> Gemfile
# Instalar las gemas
bundle install
# Generar la migración para almacenar Feature Flags en PostgreSQL
rails g flipper:active_record
# Ejecutar migraciones
rails db:migrate
# Añadir archivos al commit
git add .
git commit -m "feat(feature-flags): instala Flipper y configura PostgreSQL como backend"
📌 Commit 5.2: Agregar Interfaz de Administración de Feature Flags
🔹 Mensaje de commit:
feat(feature-flags): agrega interfaz de administración para gestionar Feature Flags en Rails
🔹 Contenido del commit:
# Añadir Flipper UI para gestión visual de los Feature Flags
echo "gem 'flipper-ui', '~> 1.0'" >> Gemfile
# Instalar la gema
bundle install
# Agregar rutas para la interfaz de Flipper
echo "
Rails.application.routes.draw do
mount Flipper::UI.app(Flipper) => '/flipper'
end
" >> config/routes.rb
# Añadir archivos al commit
git add .
git commit -m "feat(feature-flags): agrega interfaz de administración para gestionar Feature Flags en Rails"
📝 Explicación y Código Generado
Configurar Flipper en Rails (config/initializers/flipper.rb)
require "flipper"
require "flipper/adapters/active_record"
Flipper.configure do |config|
config.default do
Flipper.new(Flipper::Adapters::ActiveRecord.new)
end
end
Ejemplo de Uso en Rails Console
# Activar una nueva funcionalidad solo para ciertos usuarios
Flipper.enable(:nuevo_dashboard, user)
# Desactivar la funcionalidad
Flipper.disable(:nuevo_dashboard)
# Verificar si está habilitada
Flipper.enabled?(:nuevo_dashboard, user) # => true o false
Interfaz de Administración
Después de configurar Flipper UI, podemos acceder a:
🔗 http://localhost:3000/flipper para gestionar los Feature Flags visualmente.
