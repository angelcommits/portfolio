# ✅ Paso 30: Implementar Dashboard de Webhooks con Hotwire + Turbo Streams

Ahora agregaremos un dashboard interactivo en tiempo real para visualizar los eventos de Webhooks usando Hotwire y Turbo Streams.
✅ Turbo Streams → Permite actualizar el dashboard en tiempo real sin recargar la página.
✅ Hotwire → Optimiza la experiencia del usuario con navegación rápida.
✅ Estilo moderno con Tailwind CSS → Para una UI atractiva y funcional.
📌 Commit 30.1: Configurar Turbo Streams y Hotwire en Rails
🔹 Mensaje de commit:
feat(dashboard): configura Turbo Streams y Hotwire en la aplicación
🔹 Contenido del commit:
# Añadir Hotwire al Gemfile
echo "gem 'hotwire-rails', '~> 0.1.3'" >> Gemfile
# Instalar la gema
bundle install
# Instalar Hotwire
rails hotwire:install
🔹 Añadir archivos al commit:
git add .
git commit -m "feat(dashboard): configura Turbo Streams y Hotwire en la aplicación"
📌 Commit 30.2: Crear Dashboard de Webhooks con Turbo Streams
🔹 Mensaje de commit:
feat(dashboard): agrega vista en tiempo real para eventos de Webhooks con Turbo Streams
🔹 Contenido del commit:
Definir WebhookEventsController en app/controllers/webhook_events_controller.rb
class WebhookEventsController < ApplicationController
def index
@events = WebhookEvent.order(processed_at: :desc).limit(10)
end
end
Definir Vista del Dashboard en app/views/webhook_events/index.html.erb
<h1 class="text-2xl font-bold mb-4">Eventos Webhooks en Tiempo Real</h1>
<div id="webhooks_dashboard">
  <%= turbo_stream_from "webhooks" %>
  <table class="table-auto w-full border-collapse border border-gray-300">
    <thead>
      <tr class="bg-gray-100">
        <th class="border px-4 py-2">Evento</th>
        <th class="border px-4 py-2">Estado</th>
        <th class="border px-4 py-2">Procesado</th>
      </tr>
    </thead>
    <tbody>
      <%= render @events %>
    </tbody>
  </table>
</div>
🔹 Añadir archivos al commit:
git add .
git commit -m "feat(dashboard): agrega vista en tiempo real para eventos de Webhooks con Turbo Streams"
📌 Commit 30.3: Agregar Turbo Stream a Webhooks
🔹 Mensaje de commit:
feat(dashboard): transmite eventos de Webhooks en tiempo real con Turbo Streams
🔹 Contenido del commit:
Modificar WebhookNotifier para Emitir Turbo Streams
class WebhookNotifier
SECRET_KEY = Rails.application.credentials.dig(:webhooks, :secret) || "default_secret"
def self.call(event_name, payload)
event = WebhookEvent.create!(
event_name: event_name,
payload: payload,
status: "pending",
processed_at: Time.current
)
    Turbo::StreamsChannel.broadcast_replace_to("webhooks", target: "webhooks_dashboard", partial: "webhook_events/event", locals: { event: event })
end
end
Crear Partial de Webhook en app/views/webhook_events/\_event.html.erb
<tr>
  <td class="border px-4 py-2"><%= event.event_name %></td>
  <td class="border px-4 py-2"><%= event.status %></td>
  <td class="border px-4 py-2"><%= event.processed_at %></td>
</tr>
🔹 Añadir archivos al commit:
git add .
git commit -m "feat(dashboard): transmite eventos de Webhooks en tiempo real con Turbo Streams"
📌 Commit 30.4: Agregar Estilos con Tailwind CSS
🔹 Mensaje de commit:
feat(dashboard): mejora la UI del dashboard con Tailwind CSS
🔹 Contenido del commit:
Instalar Tailwind CSS
rails tailwindcss:install
Modificar app/assets/stylesheets/application.tailwind.css
@tailwind base;
@tailwind components;
@tailwind utilities;
Actualizar Vista index.html.erb con Clases de Tailwind
<h1 class="text-2xl font-bold mb-4 text-center">Eventos Webhooks en Tiempo Real</h1>
<div id="webhooks_dashboard" class="max-w-4xl mx-auto bg-white p-4 shadow-md rounded-lg">
  <%= turbo_stream_from "webhooks" %>
  <table class="table-auto w-full border-collapse border border-gray-300">
    <thead>
      <tr class="bg-blue-500 text-white">
        <th class="border px-4 py-2">Evento</th>
        <th class="border px-4 py-2">Estado</th>
        <th class="border px-4 py-2">Procesado</th>
      </tr>
    </thead>
    <tbody>
      <%= render @events %>
    </tbody>
  </table>
</div>
🔹 Añadir archivos al commit:
git add .
git commit -m "feat(dashboard): mejora la UI del dashboard con Tailwind CSS"
📝 Explicación y Código Generado
Cómo Acceder al Dashboard
    URL: http://localhost:3000/webhooks/events
    Eventos aparecen en tiempo real sin recargar la página.
Ejemplo de Envío de Webhook en Rails Console
WebhookNotifier.call("order.completed", { order_id: 123, status: "completed" })
Ejemplo de Simulación de Evento en la Vista
curl -X POST "http://localhost:3000/webhooks" \
 -H "Content-Type: application/json" \
 -d '{ "event": "order.completed", "order_id": 123 }'
