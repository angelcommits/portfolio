# âœ… Paso 9: Implementar Elasticsearch + Searchkick para BÃºsqueda Full-Text

Ahora configuraremos Elasticsearch con Searchkick, lo que nos permitirÃ¡ realizar bÃºsquedas avanzadas en la aplicaciÃ³n.
âœ… Elasticsearch â†’ Motor de bÃºsqueda altamente eficiente.
âœ… Searchkick â†’ Wrapper de Elasticsearch para Rails, facilita la indexaciÃ³n y bÃºsqueda.
âœ… AutoindexaciÃ³n â†’ Los registros se indexan automÃ¡ticamente al crearse o actualizarse.
âœ… Soporte para filtros, facetas y ranking basado en relevancia.
ğŸ“Œ Commit 9.1: Instalar Elasticsearch y Searchkick
ğŸ”¹ Mensaje de commit:
feat(search): instala Elasticsearch y configura Searchkick para bÃºsqueda full-text
ğŸ”¹ Contenido del commit:
# AÃ±adir la gema Searchkick al Gemfile
echo "gem 'searchkick', '~> 5.0'" >> Gemfile
# Instalar la gema
bundle install
# Verificar que Elasticsearch estÃ¡ corriendo (si no, iniciarlo)
curl -X GET "localhost:9200"
# AÃ±adir archivos al commit
git add .
git commit -m "feat(search): instala Elasticsearch y configura Searchkick para bÃºsqueda full-text"
ğŸ“Œ Commit 9.2: Habilitar IndexaciÃ³n en Modelos (User, Platform)
ğŸ”¹ Mensaje de commit:
feat(search): agrega bÃºsqueda en modelos User y Platform con Searchkick
ğŸ”¹ Contenido del commit:
Modificar el Modelo User
# app/models/company/business/user.rb
module Company
module Business
class User < ApplicationRecord
searchkick text_middle: [:name, :email]
      def search_data
        {
          name: name,
          email: email
        }
      end
    end
end
end
Modificar el Modelo Platform
# app/models/company/business/platform.rb
module Company
module Business
class Platform < ApplicationRecord
searchkick text_middle: [:name, :code]
      def search_data
        {
          name: name,
          code: code
        }
      end
    end
end
end
ğŸ”¹ AÃ±adir archivos al commit:
git add .
git commit -m "feat(search): agrega bÃºsqueda en modelos User y Platform con Searchkick"
ğŸ“Œ Commit 9.3: Implementar BÃºsqueda en Controladores
ğŸ”¹ Mensaje de commit:
feat(search): agrega endpoints de bÃºsqueda en UsersController y PlatformsController
ğŸ”¹ Contenido del commit:
Modificar UsersController para permitir bÃºsqueda
# app/controllers/users_controller.rb
class UsersController < ApplicationController
def index
if params[:query].present?
@users = Company::Business::User.search(params[:query])
else
@users = Company::Business::User.all
end
render json: @users
end
end
Modificar PlatformsController para permitir bÃºsqueda
# app/controllers/platforms_controller.rb
class PlatformsController < ApplicationController
def index
if params[:query].present?
@platforms = Company::Business::Platform.search(params[:query])
else
@platforms = Company::Business::Platform.all
end
render json: @platforms
end
end
ğŸ”¹ AÃ±adir archivos al commit:
git add .
git commit -m "feat(search): agrega endpoints de bÃºsqueda en UsersController y PlatformsController"
ğŸ“ ExplicaciÃ³n y CÃ³digo Generado
Ejemplo de Uso en Rails Console
# Indexar todos los registros existentes
Company::Business::User.reindex
Company::Business::Platform.reindex
# Realizar una bÃºsqueda
Company::Business::User.search("admin")
Company::Business::Platform.search("plataforma x")
Ejemplo de Uso en API
# Buscar usuarios por nombre o email
curl -X GET "http://localhost:3000/users?query=admin"
# Buscar plataformas por nombre o cÃ³digo
curl -X GET "http://localhost:3000/platforms?query=plataforma-x"
