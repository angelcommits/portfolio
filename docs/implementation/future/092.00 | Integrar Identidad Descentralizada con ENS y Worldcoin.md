# ‚úÖ Paso 92: Integrar Identidad Descentralizada con ENS y Worldcoin

Ahora agregaremos ENS y Worldcoin, permitiendo que los miembros de la DAO puedan verificar su identidad descentralizada y participar en la gobernanza con credenciales verificadas.
‚úÖ ENS (Ethereum Name Service) ‚Üí Permite asociar direcciones de wallet a nombres legibles.
‚úÖ Worldcoin (Proof of Personhood) ‚Üí Verificaci√≥n de identidad descentralizada sin KYC tradicional.
‚úÖ Web3.js + Stimulus.js ‚Üí Para vincular ENS y Worldcoin desde la UI.
‚úÖ Integraci√≥n con la DAO ‚Üí Se usa ENS para gobernanza y Worldcoin para verificar unicidad de votantes.
üìå Commit 92.1: Integrar ENS para Vincular Identidad Descentralizada
üîπ Mensaje de commit:
feat(ens-integration): agrega soporte para ENS en la DAO para identidad descentralizada
üîπ Contenido del commit:
Modificar app/javascript/controllers/ens_controller.js
import { Controller } from "@hotwired/stimulus";
import Web3 from "web3";
export default class extends Controller {
  static targets = ["ensName", "walletAddress"];
  async resolveENS() {
    if (!window.ethereum) {
      alert("Por favor instala MetaMask");
      return;
    }
    const web3 = new Web3(window.ethereum);
    await window.ethereum.request({ method: "eth_requestAccounts" });
    const ensName = this.ensNameTarget.value;
    const address = await web3.eth.ens.getAddress(ensName);
    this.walletAddressTarget.innerText = `Direcci√≥n asociada: ${address}`;
  }
}
Modificar app/views/ens/index.html.erb
<h2>Consultar Direcci√≥n ENS</h2>
<label>Nombre ENS:</label>
<input type="text" data-ens-target="ensName">
<button data-controller="ens" data-action="click->ens#resolveENS">
  Resolver ENS
</button>
<p data-ens-target="walletAddress">Direcci√≥n asociada: --</p>
üîπ A√±adir archivos al commit:
git add .
git commit -m "feat(ens-integration): agrega soporte para ENS en la DAO para identidad descentralizada"
üìå Commit 92.2: Integrar Verificaci√≥n de Identidad con Worldcoin
üîπ Mensaje de commit:
feat(worldcoin-integration): agrega verificaci√≥n de identidad descentralizada con Worldcoin en la DAO
üîπ Contenido del commit:
Modificar app/javascript/controllers/worldcoin_controller.js
import { Controller } from "@hotwired/stimulus";
import WorldID from "@worldcoin/id";
export default class extends Controller {
  async verifyIdentity() {
    const worldID = new WorldID({
      actionId: "worldcoin-verification",
      signal: "dao-governance",
      appName: "MyDAO",
      onSuccess: async (proof) => {
        const response = await fetch("/worldcoin/verify", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ proof })
        });
        if (response.ok) {
          alert("Identidad verificada con √©xito");
        } else {
          alert("Error verificando identidad");
        }
      },
      onError: (error) => {
        console.error(error);
        alert("Verificaci√≥n fallida");
      }
    });
    worldID.open();
  }
}
Modificar app/views/worldcoin/index.html.erb
<h2>Verificaci√≥n de Identidad con Worldcoin</h2>
<button data-controller="worldcoin" data-action="click->worldcoin#verifyIdentity">
  Verificar Identidad
</button>
üîπ A√±adir archivos al commit:
git add .
git commit -m "feat(worldcoin-integration): agrega verificaci√≥n de identidad descentralizada con Worldcoin en la DAO"
üìå Commit 92.3: Integrar ENS y Worldcoin en la Gobernanza de la DAO
üîπ Mensaje de commit:
feat(identity-governance): agrega ENS y Worldcoin como requerimientos para votar en la DAO
üîπ Contenido del commit:
Modificar TallyGovernor.sol para Requerir Identidad ENS y Worldcoin
function canVote(address voter) public view returns (bool) {
    require(bytes(ens.getName(voter)).length > 0, "ENS no registrado");
    require(worldcoinRegistry.isVerified(voter), "Identidad no verificada");
    return true;
}
function castVote(uint256 proposalId, uint8 support) external override {
    require(canVote(msg.sender), "No tienes acceso para votar");
    super.castVote(proposalId, support);
}
üîπ A√±adir archivos al commit:
git add .
git commit -m "feat(identity-governance): agrega ENS y Worldcoin como requerimientos para votar en la DAO"
üìù Explicaci√≥n y C√≥digo Generado
Ejemplo de Consulta de ENS en API
curl -X GET "http://localhost:3000/ens/resolve?name=myname.eth"
‚úÖ Retorna la direcci√≥n asociada a un ENS.
Ejemplo de Verificaci√≥n de Identidad en API
curl -X POST "http://localhost:3000/worldcoin/verify" \
  -H "Content-Type: application/json" \
  -d '{ "proof": "0xProofHash" }'
‚úÖ El usuario queda verificado con Worldcoin.
Ejemplo de Voto con Identidad Descentralizada
curl -X POST "http://localhost:3000/governance/vote" \
  -H "Content-Type: application/json" \
  -d '{ "proposalId": 1, "support": 1 }'
‚úÖ Solo votantes con ENS y Worldcoin pueden participar.
Ejemplo de Panel de Identidad en Web
https://app.ens.domains/
https://worldcoin.org/
‚úÖ Los usuarios pueden verificar sus credenciales descentralizadas.
