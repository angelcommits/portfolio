# ‚úÖ Paso 118: Integrar Subvenciones y Financiamiento DAO con Gitcoin Grants

Ahora agregaremos Gitcoin Grants, permitiendo que la DAO solicite y distribuya fondos a proyectos basados en financiamiento cuadr√°tico.
‚úÖ Financiamiento Cuadr√°tico ‚Üí Asigna fondos seg√∫n el nivel de apoyo de la comunidad.
‚úÖ Gesti√≥n Descentralizada de Subvenciones ‚Üí Cualquiera puede proponer y recibir financiamiento.
‚úÖ Compatibilidad con Safe Multi-Sig ‚Üí La DAO controla la distribuci√≥n de fondos.
‚úÖ Web3.js + Stimulus.js ‚Üí Para interactuar con Gitcoin Grants desde la UI.
‚úÖ Smart Contracts en Solidity ‚Üí Para gestionar aplicaciones y desembolsos de fondos.
üìå Commit 118.1: Configurar Gitcoin Grants para la DAO
üîπ Mensaje de commit:
feat(gitcoin-config): configura Gitcoin Grants para financiamiento de proyectos en la DAO
üîπ Contenido del commit:
1Ô∏è‚É£ Registrar la DAO en Gitcoin Grants
    Definir el fondo de financiamiento de la DAO.
    Configurar m√©todo de distribuci√≥n (cuadr√°tico o lineal).
2Ô∏è‚É£ A√±adir Configuraci√≥n en config/gitcoin.yml
gitcoin:
  enabled: true
  funding_pool: "100000 USDC"
  distribution_method: "quadratic"
  safe_address: "0xYourSafeAddress"
  matching_pool: "50000 USDC" # Fondos de la DAO para igualar donaciones
üîπ A√±adir archivos al commit:
git add .
git commit -m "feat(gitcoin-config): configura Gitcoin Grants para financiamiento de proyectos en la DAO"
üìå Commit 118.2: Implementar Smart Contract para Gesti√≥n de Subvenciones
üîπ Mensaje de commit:
feat(gitcoin-grants-contract): agrega smart contract para gestionar subvenciones y financiamiento en la DAO con Gitcoin
üîπ Contenido del commit:
Definir GitcoinGrants.sol en contracts/GitcoinGrants.sol
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;
import "@openzeppelin/contracts/access/Ownable.sol";
import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
contract GitcoinGrants is Ownable {
    IERC20 public usdc;
    address public safeWallet;
    struct Grant {
        address recipient;
        string description;
        uint256 requestedAmount;
        uint256 receivedAmount;
        bool approved;
    }
    mapping(uint256 => Grant) public grants;
    uint256 public grantCounter;
    event GrantSubmitted(uint256 grantId, address indexed recipient, uint256 requestedAmount);
    event GrantFunded(uint256 grantId, uint256 amount);
    constructor(IERC20 _usdc, address _safeWallet) {
        usdc = _usdc;
        safeWallet = _safeWallet;
    }
    function submitGrant(string memory description, uint256 requestedAmount) external {
        require(requestedAmount > 0, "Monto debe ser mayor a 0");
        grants[grantCounter] = Grant(msg.sender, description, requestedAmount, 0, false);
        emit GrantSubmitted(grantCounter, msg.sender, requestedAmount);
        grantCounter++;
    }
    function fundGrant(uint256 grantId, uint256 amount) external onlyOwner {
        require(grants[grantId].approved, "Subvenci√≥n no aprobada");
        require(usdc.transferFrom(safeWallet, grants[grantId].recipient, amount), "Transferencia fallida");
        grants[grantId].receivedAmount += amount;
        emit GrantFunded(grantId, amount);
    }
}
üîπ A√±adir archivos al commit:
git add .
git commit -m "feat(gitcoin-grants-contract): agrega smart contract para gestionar subvenciones y financiamiento en la DAO con Gitcoin"
üìå Commit 118.3: Integrar UI para Aplicar y Recibir Fondos de Gitcoin Grants
üîπ Mensaje de commit:
feat(gitcoin-ui): agrega UI para aplicar a subvenciones y recibir financiamiento en la DAO con Gitcoin Grants
üîπ Contenido del commit:
Modificar app/javascript/controllers/gitcoin_controller.js
import { Controller } from "@hotwired/stimulus";
import Web3 from "web3";
export default class extends Controller {
  static targets = ["description", "amount", "grantId"];
  async submitGrant() {
    if (!window.ethereum) {
      alert("Por favor instala MetaMask");
      return;
    }
    const web3 = new Web3(window.ethereum);
    await window.ethereum.request({ method: "eth_requestAccounts" });
    const description = this.descriptionTarget.value;
    const amount = Web3.utils.toWei(this.amountTarget.value, "ether");
    const contract = new web3.eth.Contract(
      [{ name: "submitGrant", type: "function", inputs: [{ name: "description", type: "string" }, { name: "requestedAmount", type: "uint256" }] }],
      "0xYourGitcoinGrantsContractAddress"
    );
    await contract.methods.submitGrant(description, amount).send({
      from: window.ethereum.selectedAddress,
    });
    alert("Solicitud de subvenci√≥n enviada con √©xito");
  }
  async fundGrant() {
    if (!window.ethereum) {
      alert("Por favor instala MetaMask");
      return;
    }
    const web3 = new Web3(window.ethereum);
    await window.ethereum.request({ method: "eth_requestAccounts" });
    const grantId = parseInt(this.grantIdTarget.value, 10);
    const contract = new web3.eth.Contract(
      [{ name: "fundGrant", type: "function", inputs: [{ name: "grantId", type: "uint256" }, { name: "amount", type: "uint256" }] }],
      "0xYourGitcoinGrantsContractAddress"
    );
    await contract.methods.fundGrant(grantId, Web3.utils.toWei("100", "ether")).send({
      from: window.ethereum.selectedAddress,
    });
    alert("Subvenci√≥n financiada con √©xito");
  }
}
Modificar app/views/gitcoin/index.html.erb
<h2>Solicitar Subvenci√≥n con Gitcoin Grants</h2>
<label>Descripci√≥n del Proyecto:</label>
<input type="text" data-gitcoin-target="description">
<label>Monto Solicitado (USDC):</label>
<input type="text" data-gitcoin-target="amount">
<button data-controller="gitcoin" data-action="click->gitcoin#submitGrant">
  Enviar Solicitud
</button>
<h2>Financiar Subvenci√≥n</h2>
<label>ID de la Subvenci√≥n:</label>
<input type="text" data-gitcoin-target="grantId">
<button data-controller="gitcoin" data-action="click->gitcoin#fundGrant">
  Financiar Subvenci√≥n
</button>
üîπ A√±adir archivos al commit:
git add .
git commit -m "feat(gitcoin-ui): agrega UI para aplicar a subvenciones y recibir financiamiento en la DAO con Gitcoin Grants"
üìù Explicaci√≥n y C√≥digo Generado
Ejemplo de Aplicaci√≥n a Subvenci√≥n en API
curl -X POST "http://localhost:3000/gitcoin/submit_grant" \
  -H "Content-Type: application/json" \
  -d '{ "description": "Proyecto DeFi", "requested_amount": 5000 }'
‚úÖ Env√≠a una solicitud de subvenci√≥n en Gitcoin.
Ejemplo de Financiamiento de Subvenci√≥n en API
curl -X POST "http://localhost:3000/gitcoin/fund_grant" \
  -H "Content-Type: application/json" \
  -d '{ "grant_id": 1, "amount": 500 }'
‚úÖ Financia un proyecto aprobado con fondos de la DAO.
Ejemplo de Panel de Subvenciones en Gitcoin Grants
https://gitcoin.co/grants/
‚úÖ Los miembros de la DAO pueden ver y financiar proyectos.
