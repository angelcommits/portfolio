# âœ… Paso 105: Integrar GeneraciÃ³n de Reportes On-Chain con Dune Analytics

Ahora agregaremos Dune Analytics, permitiendo que la DAO tenga reportes en tiempo real sobre su actividad on-chain, incluyendo tesorerÃ­a, gobernanza y participaciÃ³n.
âœ… AnÃ¡lisis de Datos On-Chain â†’ Se consulta informaciÃ³n directamente desde la blockchain.
âœ… VisualizaciÃ³n en Tiempo Real â†’ Dashboards con grÃ¡ficos de tesorerÃ­a, gobernanza y liquidez.
âœ… Soporte para Ethereum y L2s â†’ Compatible con redes como Optimism, Arbitrum y Polygon.
âœ… Web3.js + Stimulus.js â†’ Para integrar consultas de Dune desde la UI.
ğŸ“Œ Commit 105.1: Configurar Dune Analytics para la DAO
ğŸ”¹ Mensaje de commit:
feat(dune-analytics): configura integraciÃ³n con Dune Analytics para reportes de la DAO
ğŸ”¹ Contenido del commit:
1ï¸âƒ£ Registrar la DAO en Dune Analytics
    Crear una cuenta y definir consultas SQL para obtener mÃ©tricas on-chain.
2ï¸âƒ£ AÃ±adir ConfiguraciÃ³n en config/dune.yml
dune:
  api_key: "YOUR_DUNE_API_KEY"
  dao_contract: "0xDAOContractAddress"
  queries:
    treasury_balance: 123456  # ID de la consulta en Dune
    governance_participation: 654321
    defi_investments: 789123
ğŸ”¹ AÃ±adir archivos al commit:
git add .
git commit -m "feat(dune-analytics): configura integraciÃ³n con Dune Analytics para reportes de la DAO"
ğŸ“Œ Commit 105.2: Implementar Servicio de Consultas a Dune Analytics
ğŸ”¹ Mensaje de commit:
feat(dune-api): agrega servicio para consultar mÃ©tricas de la DAO en Dune Analytics
ğŸ”¹ Contenido del commit:
Definir DuneAnalyticsService.rb en app/services/dune_analytics_service.rb
require "httparty"
class DuneAnalyticsService
  DUNE_API_URL = "https://api.dune.com/api/v1/query"
  API_KEY = ENV["DUNE_API_KEY"]
  def self.fetch_report(query_id)
    response = HTTParty.get("#{DUNE_API_URL}/#{query_id}/results", headers: { "X-Dune-API-Key" => API_KEY })
    return JSON.parse(response.body) if response.success?
    nil
  end
  def self.treasury_balance
    fetch_report(ENV["DUNE_TREASURY_QUERY"])
  end
  def self.governance_participation
    fetch_report(ENV["DUNE_GOVERNANCE_QUERY"])
  end
end
ğŸ”¹ AÃ±adir archivos al commit:
git add .
git commit -m "feat(dune-api): agrega servicio para consultar mÃ©tricas de la DAO en Dune Analytics"
ğŸ“Œ Commit 105.3: Integrar UI para VisualizaciÃ³n de Datos On-Chain
ğŸ”¹ Mensaje de commit:
feat(dune-ui): agrega UI para visualizar reportes on-chain de la DAO con Dune Analytics
ğŸ”¹ Contenido del commit:
Modificar app/javascript/controllers/dune_controller.js
import { Controller } from "@hotwired/stimulus";
export default class extends Controller {
  static targets = ["treasury", "governance"];
  async loadTreasuryReport() {
    const response = await fetch("/dune/treasury");
    const data = await response.json();
    this.treasuryTarget.innerText = JSON.stringify(data, null, 2);
  }
  async loadGovernanceReport() {
    const response = await fetch("/dune/governance");
    const data = await response.json();
    this.governanceTarget.innerText = JSON.stringify(data, null, 2);
  }
}
Modificar app/views/dune/index.html.erb
<h2>Reportes On-Chain con Dune Analytics</h2>
<h3>Balance de TesorerÃ­a</h3>
<button data-controller="dune" data-action="click->dune#loadTreasuryReport">
  Cargar Reporte
</button>
<pre data-dune-target="treasury">No disponible</pre>
<h3>ParticipaciÃ³n en Gobernanza</h3>
<button data-controller="dune" data-action="click->dune#loadGovernanceReport">
  Cargar Reporte
</button>
<pre data-dune-target="governance">No disponible</pre>
ğŸ”¹ AÃ±adir archivos al commit:
git add .
git commit -m "feat(dune-ui): agrega UI para visualizar reportes on-chain de la DAO con Dune Analytics"
ğŸ“ ExplicaciÃ³n y CÃ³digo Generado
Ejemplo de Consulta de Balance de TesorerÃ­a en API
curl -X GET "http://localhost:3000/dune/treasury"
âœ… Retorna el balance de la DAO en tiempo real desde Dune.
Ejemplo de Consulta de ParticipaciÃ³n en Gobernanza en API
curl -X GET "http://localhost:3000/dune/governance"
âœ… Muestra las tasas de participaciÃ³n en votaciones on-chain.
Ejemplo de Panel de Reportes en Dune Analytics
https://dune.com/
âœ… Los miembros de la DAO pueden ver y analizar mÃ©tricas on-chain en tiempo real.
