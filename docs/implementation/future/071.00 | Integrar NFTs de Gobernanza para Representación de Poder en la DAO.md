# âœ… Paso 71: Integrar NFTs de Gobernanza para RepresentaciÃ³n de Poder en la DAO

Ahora implementaremos NFTs de Gobernanza, permitiendo que los derechos de voto en la DAO sean representados por NFTs transferibles. Esto facilitarÃ¡ la compra, venta y delegaciÃ³n de influencia dentro de la comunidad.
âœ… ERC-721 Governance NFTs â†’ Cada NFT representa derechos de voto en la DAO.
âœ… VotaciÃ³n Basada en NFTs â†’ El poder de voto depende del nÃºmero de NFTs que posea un usuario.
âœ… Mercado de Gobernanza â†’ Los NFTs pueden comprarse o transferirse en OpenSea.
âœ… Web3.js + Stimulus.js â†’ Para ver, transferir y votar con NFTs de gobernanza.
âœ… Smart Contract en Solidity â†’ Para acuÃ±ar y gestionar NFTs de gobernanza.
ðŸ“Œ Commit 71.1: Crear Smart Contract para NFTs de Gobernanza (ERC-721)
ðŸ”¹ Mensaje de commit:
feat(nft-governance): agrega smart contract para gobernanza basada en NFTs
ðŸ”¹ Contenido del commit:
Definir GovernanceNFT.sol en contracts/GovernanceNFT.sol
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;
import "@openzeppelin/contracts/token/ERC721/extensions/ERC721Enumerable.sol";
import "@openzeppelin/contracts/access/Ownable.sol";
contract GovernanceNFT is ERC721Enumerable, Ownable {
    uint256 public nextTokenId;
    mapping(uint256 => uint256) public votingPower;
    event NFTMinted(address indexed user, uint256 tokenId, uint256 power);
    event VotingPowerUpdated(uint256 tokenId, uint256 power);
    constructor() ERC721("Governance NFT", "GOVNFT") {}
    function mintNFT(address user, uint256 power) external onlyOwner {
        uint256 tokenId = nextTokenId++;
        _mint(user, tokenId);
        votingPower[tokenId] = power;
        emit NFTMinted(user, tokenId, power);
    }
    function updateVotingPower(uint256 tokenId, uint256 power) external onlyOwner {
        require(_exists(tokenId), "NFT no existe");
        votingPower[tokenId] = power;
        emit VotingPowerUpdated(tokenId, power);
    }
    function getVotingPower(uint256 tokenId) external view returns (uint256) {
        return votingPower[tokenId];
    }
}
Compilar y Desplegar Contrato
npx hardhat compile
npx hardhat run scripts/deploy.js --network goerli
âœ… Guardar la direcciÃ³n del contrato para el backend.
ðŸ”¹ AÃ±adir archivos al commit:
git add .
git commit -m "feat(nft-governance): agrega smart contract para gobernanza basada en NFTs"
ðŸ“Œ Commit 71.2: Integrar AcuÃ±aciÃ³n de NFTs de Gobernanza en Frontend
ðŸ”¹ Mensaje de commit:
feat(nft-governance): integra acuÃ±aciÃ³n de NFTs de gobernanza en Web3.js
ðŸ”¹ Contenido del commit:
Modificar app/javascript/controllers/nft_governance_controller.js
import { Controller } from "@hotwired/stimulus";
import Web3 from "web3";
export default class extends Controller {
  static targets = ["power"];
  async mintGovernanceNFT() {
    if (!window.ethereum) {
      alert("Por favor instala MetaMask");
      return;
    }
    const web3 = new Web3(window.ethereum);
    await window.ethereum.request({ method: "eth_requestAccounts" });
    const power = this.powerTarget.value;
    const contract = new web3.eth.Contract(
      [
        { name: "mintNFT", type: "function", inputs: [{ name: "user", type: "address" }, { name: "power", type: "uint256" }] }
      ],
      "0xYourGovernanceNFTContractAddress"
    );
    await contract.methods.mintNFT(window.ethereum.selectedAddress, power).send({ from: window.ethereum.selectedAddress });
    alert("NFT de Gobernanza acuÃ±ado con Ã©xito");
  }
}
Modificar app/views/nft_governance/index.html.erb
<h2>AcuÃ±ar NFT de Gobernanza</h2>
<label>Poder de Voto:</label>
<input type="text" data-nft-governance-target="power">
<button data-controller="nft-governance" data-action="click->nft-governance#mintGovernanceNFT">
  AcuÃ±ar NFT de Gobernanza
</button>
ðŸ”¹ AÃ±adir archivos al commit:
git add .
git commit -m "feat(nft-governance): integra acuÃ±aciÃ³n de NFTs de gobernanza en Web3.js"
ðŸ“Œ Commit 71.3: Implementar VotaciÃ³n Basada en NFTs en DAO
ðŸ”¹ Mensaje de commit:
feat(nft-governance): agrega votaciÃ³n basada en NFTs de gobernanza en DAO
ðŸ”¹ Contenido del commit:
Modificar AragonVoice.sol para VotaciÃ³n con NFTs
function vote(uint256 proposalId, uint256 tokenId, bool voteYes) external {
    require(ownerOf(tokenId) == msg.sender, "No eres dueÃ±o del NFT");
    uint256 power = votingPower[tokenId];
    require(power > 0, "Este NFT no tiene poder de voto");
    proposals[proposalId].voted[msg.sender] = true;
    if (voteYes) {
        proposals[proposalId].yesVotes += power;
    } else {
        proposals[proposalId].noVotes += power;
    }
    emit Voted(proposalId, msg.sender, voteYes);
}
ðŸ”¹ AÃ±adir archivos al commit:
git add .
git commit -m "feat(nft-governance): agrega votaciÃ³n basada en NFTs de gobernanza en DAO"
ðŸ“Œ Commit 71.4: Integrar UI para Ver Poder de Voto de NFTs
ðŸ”¹ Mensaje de commit:
feat(nft-governance): agrega UI para ver poder de voto de NFTs en DAOs usando Web3.js
ðŸ”¹ Contenido del commit:
Modificar app/javascript/controllers/nft_power_controller.js
import { Controller } from "@hotwired/stimulus";
import Web3 from "web3";
export default class extends Controller {
  static targets = ["tokenId", "power"];
  async getVotingPower() {
    if (!window.ethereum) {
      alert("Por favor instala MetaMask");
      return;
    }
    const web3 = new Web3(window.ethereum);
    await window.ethereum.request({ method: "eth_requestAccounts" });
    const tokenId = this.tokenIdTarget.value;
    const contract = new web3.eth.Contract(
      [
        { name: "getVotingPower", type: "function", inputs: [{ name: "tokenId", type: "uint256" }], outputs: [{ type: "uint256" }] }
      ],
      "0xYourGovernanceNFTContractAddress"
    );
    const power = await contract.methods.getVotingPower(tokenId).call();
    this.powerTarget.innerText = `Poder de voto: ${power}`;
  }
}
Modificar app/views/nft_governance/power.html.erb
<h2>Ver Poder de Voto de NFT</h2>
<label>ID de NFT:</label>
<input type="text" data-nft-power-target="tokenId">
<p data-nft-power-target="power">Poder de voto: --</p>
<button data-controller="nft-power" data-action="click->nft-power#getVotingPower">
  Consultar Poder de Voto
</button>
ðŸ”¹ AÃ±adir archivos al commit:
git add .
git commit -m "feat(nft-governance): agrega UI para ver poder de voto de NFTs en DAOs usando Web3.js"
