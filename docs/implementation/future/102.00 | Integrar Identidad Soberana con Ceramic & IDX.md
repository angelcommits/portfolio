# ✅ Paso 102: Integrar Identidad Soberana con Ceramic & IDX

Ahora agregaremos Ceramic & IDX, permitiendo que la DAO gestione perfiles de identidad soberana en Web3, almacenando información descentralizada sobre cada usuario.
✅ Identidad Descentralizada (DID) → Los usuarios controlan su información sin intermediarios.
✅ Almacenamiento en Ceramic → Datos de identidad almacenados de forma segura en la red Ceramic.
✅ Compatibilidad con ENS y Wallets → Los perfiles pueden vincularse a direcciones ETH o nombres ENS.
✅ Web3.js + Stimulus.js → Para que los usuarios gestionen su identidad desde la UI.
📌 Commit 102.1: Configurar Ceramic & IDX para Identidad Descentralizada
🔹 Mensaje de commit:
feat(ceramic-idx): configura Ceramic & IDX para gestión de identidad descentralizada en la DAO
🔹 Contenido del commit:
1️⃣ Registrar la DAO en Ceramic Network
    Configurar un Nodo Ceramic para la DAO.
    Crear una IDX Definition para perfiles de usuario.
2️⃣ Añadir Configuración en config/ceramic.yml
ceramic:
  node_url: "https://ceramic-clay.3boxlabs.com"
  dao_did: "did:3:kjzl6cwe1jw147xyz..."
  profile_schema: "kjzl6cwe1jw149userprofile..."
🔹 Añadir archivos al commit:
git add .
git commit -m "feat(ceramic-idx): configura Ceramic & IDX para gestión de identidad descentralizada en la DAO"
📌 Commit 102.2: Implementar Perfiles de Identidad en Ceramic IDX
🔹 Mensaje de commit:
feat(ceramic-profiles): agrega soporte para perfiles de identidad descentralizada con Ceramic IDX
🔹 Contenido del commit:
Modificar app/javascript/controllers/ceramic_controller.js
import { Controller } from "@hotwired/stimulus";
import { DID } from "dids";
import { CeramicClient } from "@ceramicnetwork/http-client";
import { IDX } from "@ceramicstudio/idx";
export default class extends Controller {
  static targets = ["name", "bio", "profile"];
  async loadProfile() {
    const ceramic = new CeramicClient("https://ceramic-clay.3boxlabs.com");
    const idx = new IDX({ ceramic });
    const did = await window.ethereum.request({ method: "eth_requestAccounts" });
    const profile = await idx.get("basicProfile", did[0]);
    this.profileTarget.innerText = profile ? JSON.stringify(profile, null, 2) : "No hay perfil registrado";
  }
  async saveProfile() {
    const ceramic = new CeramicClient("https://ceramic-clay.3boxlabs.com");
    const idx = new IDX({ ceramic });
    const did = await window.ethereum.request({ method: "eth_requestAccounts" });
    const profileData = {
      name: this.nameTarget.value,
      bio: this.bioTarget.value
    };
    await idx.set("basicProfile", profileData);
    alert("Perfil guardado en Ceramic IDX");
  }
}
Modificar app/views/ceramic/index.html.erb
<h2>Gestión de Identidad con Ceramic IDX</h2>
<label>Nombre:</label>
<input type="text" data-ceramic-target="name">
<label>Bio:</label>
<input type="text" data-ceramic-target="bio">
<button data-controller="ceramic" data-action="click->ceramic#saveProfile">
  Guardar Perfil
</button>
<br><br>
<h2>Ver Perfil</h2>
<button data-controller="ceramic" data-action="click->ceramic#loadProfile">
  Cargar Perfil
</button>
<pre data-ceramic-target="profile">No hay perfil registrado</pre>
🔹 Añadir archivos al commit:
git add .
git commit -m "feat(ceramic-profiles): agrega soporte para perfiles de identidad descentralizada con Ceramic IDX"
📌 Commit 102.3: Integrar Validación de Identidad en la DAO
🔹 Mensaje de commit:
feat(ceramic-dao-validation): agrega validación de identidad descentralizada en la DAO con Ceramic IDX
🔹 Contenido del commit:
Modificar app/services/identity_validator.rb
require "httparty"
class IdentityValidator
  CERAMIC_NODE = "https://ceramic-clay.3boxlabs.com"
  def self.fetch_profile(wallet_address)
    response = HTTParty.get("#{CERAMIC_NODE}/api/v0/streams/#{wallet_address}")
    return JSON.parse(response.body) if response.success?
    nil
  end
  def self.valid_identity?(wallet_address)
    profile = fetch_profile(wallet_address)
    profile && profile["name"].present?
  end
end
🔹 Añadir archivos al commit:
git add .
git commit -m "feat(ceramic-dao-validation): agrega validación de identidad descentralizada en la DAO con Ceramic IDX"
📝 Explicación y Código Generado
Ejemplo de Guardar Identidad en API
curl -X POST "http://localhost:3000/ceramic/save" \
  -H "Content-Type: application/json" \
  -d '{ "name": "Alice", "bio": "Desarrolladora Web3" }'
✅ El perfil de usuario se almacena en Ceramic IDX.
Ejemplo de Ver Perfil en API
curl -X GET "http://localhost:3000/ceramic/profile?wallet=0xUserWallet"
✅ Retorna la información del usuario desde Ceramic IDX.
Ejemplo de Validación de Identidad en API
curl -X GET "http://localhost:3000/dao/validate_identity?wallet=0xUserWallet"
✅ Solo los usuarios con un perfil en Ceramic pueden participar en la DAO.
Ejemplo de Panel de Identidad Web3 en Ceramic IDX
https://self.id/
✅ Los miembros de la DAO pueden gestionar sus credenciales descentralizadas.
